<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head><title>
  
  Secure Hashed Passwords Using Dwb and Pwdhash | Miles Sandlar
  
</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<link rel="icon" href="/style/images/favicon.ico" />
<link rel="stylesheet" href="/css/all.css"/>
<script type="text/javascript" src="/style/all.js"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22486639-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
	<body onload="sh_highlightDocument();">
		<div id="main">
			<header>
    <nav>
      
        <a  href="/front-end">Front End</a>
      
        <a  href="/interfaces">Interface</a>
      

      <span class='seperator'></span>
      
        <a  href="/miscart">&omega;</a>
      
        <a class='active' href="/blog">&beta;</a>
      
        <a  href="/contact">&#9993</a>
      
  </nav>


  <div class="right links">
    <a class="a" title="My Resume" href="/resources/resume.pdf">M</a><a target="_blank" class="b" title="My Github Account" href='http://github.com/mil'>i</a><a target="_blank" class="c" title="You've spotted me!" href='http://www.freep.com/article/20130921/news05/309210021'>l</a><a target="_blank" class="d" title="My LinkedIn Account" href='http://linkedin.com/in/sandlar'>e</a><a target="_blank" class="e" title="My Ancient Web Design Company" href='http://logicdrift.com'>s</a>
  </div>
</header>

			<div id="main-content">
	<div class="post last">
		<h2>Secure Hashed Passwords Using Dwb and Pwdhash</h2>
    <div class="date">April 25, 2012, 8:44PM</div>
		<div class="content">
			<p><a href="http://en.wikipedia.org/wiki/Cryptographic_hash_function">Password hashing</a> services like <a href="https://pwdhash.com">PwdHash</a> and <a href="http://supergenpass.com">SuperGenPass</a> allow you enter your password in the password field of any site and then by way of some Javascript your master password is replaced with its hashed counterpart. My problem with these services is that they are fundamentally insecure due to their implementation. Both PwdHash and SuperGenPass rely on replacement of your master password via Javascript after it has already been entered on the site.</p>

<p>Anyone who’s spent any time with Javascript knows it would not hard be hard to <a href="http://kuza55.blogspot.com/2007/02/attacking-pwdhash-firefox-extension.html">retrieve that master password</a> that you entered. Thus, PwdHash and SuperGenPass’s hashing implementations only work if you trust the Javascript of every site you visit. How could this ever be classified as a solution to the common household hashing problem?</p>

<p><strong>A Better Hashing Implementation</strong>: My solution involves using a browser that can offload the hashing task to another program. Using the browser, <a href="http://portix.bitbucket.org/dwb/">Dwb</a>, you can very easily set it up so that an external script passes in the hashed password to the browser and thus the master password is never exposed.</p>

<p><a href="https://github.com/mil/configs-and-bins/blob/master/configs/.config/dwb/userscripts/hash">hash</a> (<em>~/.config/userscripts/hash</em>)</p>
<pre class='sh_ruby'>
#!/usr/bin/ruby
require 'uri'
site = (URI).parse(ENV['DWB_URI']).host
password = `zenity --password`
hashedPassword = `node ~/bin/pwdhash.js #{site} #{password}`.chomp!
IO.binwrite(ENV['DWB_FIFO'], "open javascript:document.activeElement.value = '#{hashedPassword}")
</pre>
<p>This hash userscript, to be run from Dwb, essentially just uses <a href="http://library.gnome.org/users/zenity/stable">zenity</a> (<a href="http://xdialog.free.fr">Xdialog</a> works here too) to prompt the user for their master password. Then their master password along with the user’s current site is run through the commandline tool <a href="https://github.com/mil/configs-and-bins/blob/master/bins/pwdhash.js">pwdhash.js</a>. <a href="https://github.com/mil/configs-and-bins/blob/master/bins/pwdhash.js">pwdhash.js</a> is just a simple Node.js port I made of the <a href="https://pwdhash.com">PwdHash Browser Javascript Implementation</a>. Once the hashed password is returned from pwdhash.js, Dwb is then told to run some Javascript to insert <em>only the that hashed password</em> back into the currently selected password field of the current site.</p>

<p><strong>Use Case:</strong> In Dwb, once on a password field, in command mode you type the command “:hash” and a password entry dialog is spawned.</p>

<p><img src="/images/pwdhash-password-entry.png" alt="Pwdhash Password Entry Via Zenity" /></p>

<p>You type your password in the dialog (generated by zenity) and then once you hit enter your hashed password is inserted into the password field.</p>

<p><img src="/images/pwdhash-password.png" alt="Pwdhash Hashed Password on Google.Com" /></p>

<p>And there you have it - a more secure hashing implementation using Dwb in combination with PwdHash’s algorithm! No long are you exposing your master password to arbitrary Javascript.</p>
		</div>
	</div>
</div>

			<footer>
  
    <a title="Back to Blog" class="return" href="/blog">&#171;</a>
  
  <a class='copyright' href="http://creativecommons.org/licenses/by/3.0/" target="_blank" title="CC Attribution 3.0 Unported">&copy;</a>
	<span class="validate">
    <a target="_blank" title='XHTML 1.0 Transitional DTD' href="http://validator.w3.org/check?uri=http://userbound.com//blog/Secure-Hashed-Passwords-Using-Dwb-and-Pwdhash">Valid</a><a target="_blank" title='CSS2.1' href="http://jigsaw.w3.org/css-validator/validator?uri=http://userbound.com/style/all.css">ates</a>
  </span>
</footer>

		</div>
	</body>
</html>
